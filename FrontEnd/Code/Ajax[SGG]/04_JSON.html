<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AJAX ÂìçÂ∫î JSON</title>
    <style>
        #result {
            width: 200px;
            height: 100px;
            border: solid 1px #90b;
        }
    </style>
</head>

<body>
    <!--ÂΩìÊåâ‰∏ã‰ªªÊÑèÈîÆÊó∂ ÂìçÂ∫îjsonËØ∑Ê±Ç-->
    <div id="result"></div>

    <script>
        window.onkeydown = () => {
            //AjaxËØ∑Ê±Ç
            ////ÂàõÂª∫ÂØπË±°ÔºàÂú®ÊµèËßàÂô®ÊéßÂà∂Âè∞‰∏≠ÁöÑXHRÈÄâÈ°πÂ∞±ÊòØAJAXÊéßÂà∂Ôºâ
            const xhr = new XMLHttpRequest();
            ////ÂàùÂßãÂåñ ËÆæÁΩÆËØ∑Ê±ÇÁöÑÊñπÊ≥ïÂíåurl
            xhr.open('GET', 'http://127.0.0.1:3000/json-server');//1.ÂèëÈÄÅ‰ΩïÁßçÁ±ªÂûãÁöÑËØ∑Ê±Ç 2.ËØ∑Ê±ÇÂú∞ÂùÄÔºàÂèØ‰º†ÂèÇ?&Ôºâ
            ////ËÆæÁΩÆÂìçÂ∫î‰ΩìÊï∞ÊçÆÁ±ªÂûã
            xhr.responseType = 'json';
            ////ÂèëÈÄÅ
            xhr.send();
            ////‰∫ã‰ª∂ÁªëÂÆö Â§ÑÁêÜÊúçÂä°Á´ØËøîÂõûÁöÑÁªìÊûú
            xhr.onreadystatechange = () => {
                //Âà§Êñ≠ Ë°®Á§∫ÊúçÂä°Á´ØËøîÂõû‰∫ÜÊâÄÊúâÁªìÊûú
                if (xhr.readyState === 4) {
                    //Âà§Êñ≠ÂìçÂ∫îÁöÑÁä∂ÊÄÅÁ†Å
                    if (xhr.status >= 200 && xhr.status < 300) {//‰ª•2ÂºÄÂ§¥ÁöÑÁä∂ÊÄÅÁ†ÅÈÉΩË°®Á§∫Ê≠£Â∏∏
                        //Â§ÑÁêÜÁªìÊûú ÂìçÂ∫îÊä•Êñá
                        ////ÂìçÂ∫îË°å
                        console.log(xhr.status);//ÂìçÂ∫îÁä∂ÊÄÅÁ†Å
                        console.log(xhr.statusText);//ÂìçÂ∫îÁä∂ÊÄÅÂ≠óÁ¨¶‰∏≤
                        console.log(xhr.getAllResponseHeaders());//ÊâÄÊúâÂìçÂ∫îÂ§¥
                        console.log(xhr.response);//ÂìçÂ∫î‰Ωì
                        //ÊâãÂä®ÂØπÊï∞ÊçÆËøõË°åËΩ¨Êç¢
                        // let data = JSON.parse(xhr.response);
                        //Ëá™Âä®ËΩ¨Êç¢üëÜËÆæÁΩÆÂìçÂ∫î‰ΩìÊï∞ÊçÆÁ±ªÂûã‰∏∫json Âú®‰∏äËæπ
                        result.innerHTML = xhr.response.name
                    }
                }


                /**
                 * onreadystatechange
                 * on ÂΩì...ÁöÑÊó∂ÂÄô
                 * readystate ÊòØxhrÂØπË±°‰∏≠ÁöÑÂ±ûÊÄß Ë°®Á§∫Áä∂ÊÄÅ
                 *  Êúâ‰∫î‰∏™ÂÄº 
                 *      0 ÈªòËÆ§ÂÄº Ë°®Á§∫Êú™ÂàùÂßãÂåñ 
                 *      1 Ë°®Á§∫openÊñπÊ≥ïÂ∑≤ÁªèË∞ÉÁî®ÂÆåÊØï
                 *      2 Ë°®Á§∫sendÊñπÊ≥ïÂ∑≤ÁªèË∞ÉÁî®ÂÆåÊØï
                 *      3 Ë°®Á§∫ÊúçÂä°Á´ØÂ∑≤ËøîÂõûÈÉ®ÂàÜÁªìÊûú
                 *      4 Ë°®Á§∫ÊúçÂä°Á´ØÂ∑≤ËøîÂõûÊâÄÊúâÁªìÊûú
                 * change ÂΩìÊîπÂèòÁöÑÊó∂ÂÄôËß¶Âèë
                */
            }
        }
    </script>
</body>

</html>