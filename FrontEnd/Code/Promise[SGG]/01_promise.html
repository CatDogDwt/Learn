<!--
 Promiseæ˜¯JSä¸­è¿›è¡Œå¼‚æ­¥ç¼–ç¨‹çš„æ–°è§£å†³æ–¹æ¡ˆ(ES6è§„èŒƒå¼•å…¥ æ—§æ–¹æ¡ˆæ˜¯å›è°ƒå‡½æ•°)
      å¼‚æ­¥ç¼–ç¨‹ï¼šFSæ–‡ä»¶æ“ä½œã€æ•°æ®åº“æ“ä½œã€Ajaxã€å®šæ—¶å™¨
 ä»è¯­æ³•ä¸Šæ¥è¯´ promiseæ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°
 ä»åŠŸèƒ½ä¸Šæ¥è¯´ promiseå¯¹è±¡ç”¨æ¥å°è£…ä¸€ä¸ªå¼‚æ­¥æ“ä½œå¹¶å¯ä»¥è·å–å…¶æˆåŠŸ/å¤±è´¥çš„ç»“æœ
 promiseçŠ¶æ€
    å®ä¾‹å¯¹è±¡ä¸­æœ‰ä¸€ä¸ªå±æ€§ ã€PromiseStateã€‘æœ‰ä¸‰ä¸ªå€¼ pending æœªå†³å®šçš„ resolved/fullfilled å·²è§£å†³çš„ rejected æœªè§£å†³çš„
    promiseçŠ¶æ€å˜åŒ–åªæœ‰ä¸¤ç§å¯èƒ½
        pendingå˜ä¸ºresolved/fullfilled
        pendingå˜ä¸ºrejected
    ä¸”ä¸€ä¸ªpromiseå¯¹è±¡åªèƒ½æ”¹å˜ä¸€æ¬¡ æ— è®ºå˜ä¸ºæˆåŠŸè¿˜æ˜¯å¤±è´¥ éƒ½ä¼šæœ‰ä¸€ä¸ªç»“æœæ•°æ® æˆåŠŸçš„ç»“æœç§°ä¸ºvalue å¤±è´¥ç§°ä¸ºreason
 ä¼˜ç‚¹
      æŒ‡å®šå›è°ƒå‡½æ•°çš„æ–¹å¼æ›´åŠ çµæ´» æ—§çš„å›è°ƒå‡½æ•°å¿…é¡»åœ¨å¯åŠ¨å¼‚æ­¥ä»»åŠ¡å‰æŒ‡å®š
      promiseï¼šå¯åŠ¨å¼‚æ­¥ä»»åŠ¡--ğŸ‘‰è¿”å›promiseå¯¹è±¡--ğŸ‘‰ç»™promiseå¯¹è±¡ç»‘å®šå›è°ƒå‡½æ•°(ç”šè‡³å¯ä»¥åœ¨å¼‚æ­¥ä»»åŠ¡ç»“æŸåæŒ‡å®š/å¤šä¸ª)
      æ”¯æŒé“¾å¼è°ƒç”¨ å¯ä»¥è§£å†³å›è°ƒåœ°ç‹±é—®é¢˜
          å›è°ƒåœ°ç‹±ï¼šå›è°ƒå‡½æ•°åµŒå¥—è°ƒç”¨ å¤–éƒ¨å›è°ƒå‡½æ•°å¼‚æ­¥æ‰§è¡Œçš„ç»“æœæ˜¯åµŒå¥—çš„å›è°ƒæ‰§è¡Œçš„æ¡ä»¶ ä¸ä¾¿äºé˜…è¯»å’Œå¼‚å¸¸å¤„ç† è§£å†³æ–¹å¼ä¸ºpromiseé“¾å¼è°ƒç”¨
-->
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åˆä½“éªŒ</title>
</head>

<body>
    <h1>Promiseåˆä½“éªŒ</h1>
    <hr>
    <button id="btn">ç‚¹å‡»æŠ½å¥–(æ™®é€šç‰ˆ)</button>
    <button id="btnn">ç‚¹å‡»æŠ½å¥–(Promiseç‰ˆ)</button>
    <script>
        //ç”Ÿæˆéšæœºæ•°
        function rand(m, n) {
            return Math.ceil(Math.random() * (n - m + 1)) + m - 1;
        }
        //ç‚¹å‡»æŒ‰é’® 2såæ˜¾ç¤ºæ˜¯å¦ä¸­å¥–(30%æ¦‚ç‡) è‹¥ä¸­å¥–å¼¹å‡ºï¼šæ­å–œä¸­å¥– å¦‚æœªä¸­å¥– åˆ™å¼¹å‡º å†æ¥å†å‰
        ////ä¸ä½¿ç”¨promise
        btn.addEventListener('click', () => {
            //30%ä¸­å¥–æ¦‚ç‡
            setTimeout(() => {
                let n = rand(1, 100);
                if (n <= 30) {
                    alert('æ­å–œä¸­å¥–')
                } else {
                    alert('å†æ¥å†å‰')
                }
            }, 2000);
        })
        ////ä½¿ç”¨promise
        btnn.addEventListener('click', () => {
            const p = new Promise((resolve, reject) => {//æ„é€ å‡½æ•°å®ä¾‹åŒ– æ¥å—ä¸¤ä¸ªå‚æ•°resolveè§£å†³å’Œrejectæ‹’ç» éƒ½æ˜¯å‡½æ•°ç±»å‹çš„æ•°æ® å½“å¼‚æ­¥ä»»åŠ¡æˆåŠŸæ˜¯è°ƒç”¨resolve å½“å¤±è´¥æ—¶è°ƒç”¨reject
                //30%ä¸­å¥–æ¦‚ç‡
                setTimeout(() => {
                    let n = rand(1, 100);
                    if (n <= 30) {
                        resolve(n);//å¯ä»¥å°†promiseå¯¹è±¡çš„çŠ¶æ€è®¾ç½®ä¸ºæˆåŠŸ
                    } else {
                        reject(n);//å¯ä»¥å°†promiseå¯¹è±¡çš„çŠ¶æ€è®¾ç½®ä¸ºå¤±è´¥
                    }
                }, 2000);
            })
            //è°ƒç”¨thenæ–¹æ³• æ¥å—ä¸¤ä¸ªå‡½æ•°ç±»å‹å‚æ•° ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºå‡½æ•°æˆåŠŸæ—¶çš„å›è°ƒ ç¬¬äºŒä¸ªå‚æ•°ä¸ºå‡½æ•°å¤±è´¥æ—¶çš„å›è°ƒ
            p.then((value) => {
                alert('æ­å–œä¸­å¥–' + value)
            }, (reason) => {
                alert('å†æ¥å†å‰' + reason)
            })
        })
    </script>
</body>

</html>